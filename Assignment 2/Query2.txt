--part 2.2
SELECT N.N_NAME, SUM(L.L_QUANTITY*(L.L_EXTENDEDPRICE - L.L_DISCOUNT)) as s
from NATION N, LINEITEM L, SUPPLIER S, CUSTOMER C, ORDERS O
where (S.S_NATIONKEY == C.C_NATIONKEY and S.S_SUPPKEY == L.L_SUPPKEY
           and C.C_CUSTKEY == O.O_CUSTKEY and O.O_ORDERKEY == L.L_ORDERKEY
            and S.S_NATIONKEY == N.N_NATIONKEY and N.N_NATIONKEY == C.C_NATIONKEY)
group by N.N_NATIONKEY ORDER BY N.N_NAME COLLATE NOCASE;